<!DOCTYPE html>
<html lang="en" class="scrollbar">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/src/public/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Notedown</title>
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css" />
  </head>
  <body>
    <script>
      ;(function () {
        // Change these if you use something different in your hook.
        var storageKey = 'darkMode'
        var classNameDark = 'dark'
        var classNameLight = 'light'

        function setClassOnDocumentBody(darkMode) {
          document.body.classList.add(darkMode ? classNameDark : classNameLight)
          document.body.classList.remove(
            darkMode ? classNameLight : classNameDark
          )
        }

        console.log('running')

        var preferDarkQuery = '(prefers-color-scheme: dark)'
        var mql = window.matchMedia(preferDarkQuery)
        var supportsColorSchemeQuery = mql.media === preferDarkQuery
        var localStorageTheme = null
        try {
          localStorageTheme = localStorage.getItem(storageKey)
        } catch (err) {}
        var localStorageExists = localStorageTheme !== null
        if (localStorageExists) {
          localStorageTheme = JSON.parse(localStorageTheme)
        }

        // Determine the source of truth
        if (localStorageExists) {
          // source of truth from localStorage
          setClassOnDocumentBody(localStorageTheme)
        } else if (supportsColorSchemeQuery) {
          // source of truth from system
          setClassOnDocumentBody(mql.matches)
          localStorage.setItem(storageKey, mql.matches)
        } else {
          // source of truth from document.body
          var isDarkMode = document.body.classList.contains(classNameDark)
          localStorage.setItem(storageKey, JSON.stringify(isDarkMode))
        }
      })()
    </script>
    <div id="root"></div>
    <script type="module" src="./src/index.tsx"></script>
  </body>

  <script>
    const global = globalThis
  </script>
</html>
